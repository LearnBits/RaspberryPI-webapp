function Gauge(m,c){function k(a){return+a<c.range[0]||+a>c.range[1]?(e.push(Gauge.errors.invalid_tick_value),-1):c.dial_indicator.sAngle-q/(c.range[1]-c.range[0])*a}function h(a,b,c,d){d=d*Math.PI/180;a+=c*Math.cos(d);b-=c*Math.sin(d);return{x:Math.round(a),y:Math.round(b)}}function n(a,b,c){var d;a=document.createElementNS(t,a);void 0!==c&&a.setAttribute("class",c);for(d in b)b.hasOwnProperty(d)&&a.setAttribute(d,b[d]);return a}function u(){var a,b;a=[].slice.call(g.getElementsByClassName("meter_needle"));
for(b=0;b<a.length;b++)a[b].parentNode.removeChild(a[b])}function v(){var a,b,p,e;p=d.sAngle;for(e=0;e<c.zones.length;e++){b=p;p=b-q*c.zones[e].length_quota;a=d.cx;var f=d.cy,l=d.r,m=p,k=void 0,r=void 0,k=h(a,f,l,b),r=h(a,f,l,m);a=["M",k.x,",",k.y," A",d.r,",",d.r," 0, ",180>=b-m?0:1,",1 ",r.x,",",r.y].join("");a=n("path",{d:a,stroke:c.zones[e].color},"dial_indicator");g.appendChild(a)}}function w(){var a,b,e,f;for(f in c.labels)c.labels.hasOwnProperty(f)&&(b=k(f),a=h(d.cx,d.cy,d.r+c.tickLabel.interval,
b),a=n("text",a,"tick_label"),a.textContent=c.labels[f],g.appendChild(a),a=d.r+c.tickLine.interval+c.tickLine.length,e=d.r+c.tickLine.interval,a=h(d.cx,d.cy,a,b),b=h(d.cx,d.cy,e,b),b={x1:a.x,y1:a.y,x2:b.x,y2:b.y},b=n("line",b,"tick"),g.appendChild(b))}function x(){var a,b,e;a={cx:d.cx,cy:d.cy,r:c.meter_needle.circle_r};a=n("circle",a,"meter_needle");g.appendChild(a);a=h(d.cx,d.cy,d.r+c.meter_needle.interval,f);b=h(d.cx,d.cy,.5*c.meter_needle.circle_r,f+90);e=h(d.cx,d.cy,.5*c.meter_needle.circle_r,
f-90);a={points:[a.x,a.y,b.x,b.y,e.x,e.y].join()};a=n("polygon",a,"meter_needle");g.appendChild(a)}var l,f,q,d,g,e,t;this.lastError=function(){return e.join(";")};c=function(a){var b;c=c||{};for(b in a)a.hasOwnProperty(b)&&a.hasOwnProperty(b)&&!c.hasOwnProperty(b)&&(c[b]=a[b]);return c}(Gauge.default_opts);t="http://www.w3.org/2000/svg";e=[];if(0<function(){var a;e=[];if(c.range[0]>=c.range[1])e.push(Gauge.errors.invalid_option_range);else for(a in c.labels)if(c.labels.hasOwnProperty(a)&&(+a<c.range[0]||
+a>c.range[1])){e.push(Gauge.errors.invalid_option_labels);break}return e}().size)return this;if(function(){var a=!1,b;g=m.getElementsByTagName("svg");if(0<g.length)for(b=0;b<g.length&&!(a=a||"gauge"===g[b].getAttribute("class"));b++);return a}())return e.push("gauge is already exists in container"),this;d=c.dial_indicator;q=Math.abs(d.eAngle-d.sAngle);l=c.value;f=k(l);m.innerHTML="<svg class='gauge'></svg>";g=m.getElementsByTagName("svg")[0];this.setValue=function(a){e=[];l=a;f=k(l);-1!==f&&(a=f,
a>d.sAngle||f<d.eAngle?e.push(Gauge.errors.invalid_angle):f=a,u(),v(),x(),w())};u();v();x();w()}Gauge.default_opts={value:0,range:[0,6],labels:{0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6"},zones:[{length_quota:.75,color:"#686868"},{length_quota:.15,color:"#FFC458"},{length_quota:.1,color:"#FF0000"}],dial_indicator:{cx:300,cy:300,r:200,sAngle:210,eAngle:-30},tickLabel:{interval:35},tickLine:{interval:10,length:10},meter_needle:{circle_r:10,interval:10}};
Gauge.errors={invalid_option_range:"Invalid range",invalid_option_labels:"Invalid labels",invalid_tick_value:"Invalid value",invalid_angle:"Invalid angle"};
